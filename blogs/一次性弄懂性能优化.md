# 一次性弄懂性能优化

> 3快、1流畅
>
> 压缩、缓存、并发

## 1. 打包构建快（开发）

#### 1.1 并发构建

- 使用多进程打包：正常打包是单线程处理的，我们可以使用一些插件，让它开启多进程同时处理

#### 1.2 过滤不相关目录



#### 1.3 使用缓存



## 2. 资源加载快（下载）

> 想象寄收快递

### 2.1 体积要小

- 图片压缩
- HTML 压缩
- CSS 压缩合并
- JS 压缩合并
- 服务端开启 Gzip
- CSSSprite（已废弃）
- SVG icon
- 图片懒加载
- 模块懒加载
- TreeShaking
- 抽离公共模块（模块化）

### 2.2 缓存（资源复用）

- 静态资源缓存：HTTP 缓存

### 2.3 距离要近

- 静态资源（CSS、JS、图片）放在 CDN

### 2.4 运输工具要先进

> 并行运输

- 升级到HTTP2
  - 二进制分帧
  - 多路复用
  - 数据流优先级
  - 头部压缩
  - 服务器推送

## 3. 页面展现快（渲染）

### 3.1 CSS 在上、JS 在下

- 先加载 CSS

### 3.2 不重要的资源使用 async 或者 defer 属性异步加载

### 3.3 加载 CSS 用 link，少用 @import

## 4. 体验流畅（用户体验）

### 4.1 动画流畅

- 尽量使用 transform 和 animation，不用 JS 实现动画

- 使用 transform 和 opacity，少用 left/top
  - 开启硬件加速：使用 GPU，比CPU快很多

- JS 动画使用 requestAnimationFrame，少用 setInterval

### 4.2 滚动/移动流畅

- DOM 增删操作要少（虚拟长列表、DOM Diff）
  - 虚拟参列表类似cocos写的滚动列表组件

- 高频操作防抖和节流
  - 减少频率

### 4.3 辅助计算

- WebWorker

